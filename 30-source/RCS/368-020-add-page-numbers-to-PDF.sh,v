head	1.3;
access;
symbols;
locks
	scarol:1.3; strict;
comment	@# @;


1.3
date	2025.10.11.18.16.23;	author scarol;	state Exp;
branches;
next	1.2;

1.2
date	2025.10.11.17.41.46;	author scarol;	state Exp;
branches;
next	1.1;

1.1
date	2025.10.11.16.32.20;	author scarol;	state Exp;
branches;
next	;


desc
@@


1.3
log
@began skipping page logic
@
text
@#!/bin/sh
# $Source: /srv/368-pdf-utilities/30-source/RCS/368-020-add-page-numbers-to-PDF.sh,v $
# $Date: 2025/10/11 17:41:46 $
# $Revision: 1.2 $
# $State: Exp $

# original created by Anthopic Claude 20251010

show_help() {
cat << EOF
Usage: $(basename "$0") -n NUMPAGES -i INPUT.pdf -o OUTPUT.pdf

Overlay page numbers at the bottom center of a PDF.

Options:
  -h          Show this help message
  -n NUMPAGES Number of pages to number (required)
  -i INPUT    Input PDF file (required)
  -o OUTPUT   Output PDF file (required)
  -s SKIP     (tbd) Number of pages to skip before numbering

Requirements:
  - ghostscript (gs command)
  - pdftk

Example:
  $(basename "$0") -n 25  -s 1 -i document.pdf -o numbered.pdf
EOF
}


echo "\n[green] cmd line options: $@@" | rich -p -


# Initialize variables
NUMPAGES=""
INPUT=""
OUTPUT=""
SKIP=0

# Parse arguments
while getopts "hn:i:o:s:" opt; do
  case $opt in
    h) show_help; exit 0 ;;
    n) NUMPAGES="$OPTARG" ;;
    i) INPUT="$OPTARG" ;;
    o) OUTPUT="$OPTARG" ;;
    s) SKIP="$OPTARG" ;;
    *) show_help; exit 1 ;;
  esac
done

# Validate required arguments
if [ -z "$NUMPAGES" ] || [ -z "$INPUT" ] || [ -z "$OUTPUT" ]; then
  echo "Error: Missing required arguments" >&2
  show_help
  exit 1
fi

if [ ! -f "$INPUT" ]; then
  echo "Error: Input file '$INPUT' not found" >&2
  exit 1
fi

SKIPTO=$((SKIP + 1 ))

# Create temporary PostScript file
TMPPS=$(mktemp /tmp/pagenums.XXXXXX.ps)
TMPPDF=$(mktemp /tmp/pagenums.XXXXXX.pdf)

cat > "$TMPPS" << 'EOF'
/Arial findfont 12 scalefont setfont

1 1 NUMPAGES {
  /pagenum exch def
  << /PageSize [612 792] >> setpagedevice
  306 20 moveto
  pagenum =string cvs dup stringwidth pop 2 div neg 0 rmoveto show
  showpage
} for
EOF

# Substitute NUMPAGES value
sed -i.bak "s/NUMPAGES/$NUMPAGES/" "$TMPPS"
# sed -i.bak "s/SKIPTO/$SKIPTO/" "$TMPPS"

# Convert PostScript to PDF
gs -dBATCH -dNOPAUSE -dQUIET -sDEVICE=pdfwrite -sOutputFile="$TMPPDF" "$TMPPS"

# Overlay page numbers
pdftk "$INPUT" multistamp "$TMPPDF" output "$OUTPUT"

# Cleanup
rm -f "$TMPPS" "$TMPPS.bak" "$TMPPDF"

echo "Page numbers added: $OUTPUT"

@


1.2
log
@added display of cmd line opts passed in
@
text
@d3 2
a4 2
# $Date: 2025/10/11 16:32:20 $
# $Revision: 1.1 $
d20 1
d27 1
a27 1
  $(basename "$0") -n 25 -i document.pdf -o numbered.pdf
d39 1
d42 1
a42 1
while getopts "hn:i:o:" opt; do
d48 1
d65 2
d85 1
@


1.1
log
@Initial revision
@
text
@d2 4
a5 4
# $Source$
# $Date$
# $Revision$
# $State$
d29 4
@
